<%= render "shared_partials/navigation_menu", :active_item => "admin"%>

<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">Administraci√≥n de Sistema</h1>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Administradores de Sistema
                </div>
                <div class="panel-body">
                	<div class="table-responsive">
                		<table class="table table-striped table-bordered">
                			<thead>
                				<th>ID</th>
                				<th>Nombre</th>
                				<th>Username</th>
                				<th>Rol</th>
                				<th>Eliminar</th>
                			</thead>
                			<tbody>
                				<%@managers.each do |m|%>
                				<tr>
                					<td><%=m.id%></td>
                					<td><%=m.firstname+" "+m.lastname%></td>
                					<td><%=m.username%></td>
                					<td><%=get_rolename(m.roleid)%></td>
                					<%if m.id != 182%>
                						<td style="text-align: center;"><%=link_to "<i class='fa fa-times'></i>".html_safe, {:controller => "main", :action => "unassign_system_manager", :params => {:userid => m.id}}, {:class => "btn btn-circle btn-default btn-danger", :method => :delete, :data => {:confirm => "Estas Seguro?"}}%></td>
                					<%else%>
                						<td style="text-align: center;"><%=link_to "<i class='fa fa-times'></i>".html_safe, {}, {:class => "btn btn-circle btn-default btn-danger", :disabled => true}%></td>
                					<%end%>
                				</tr>
                				<%end%>
                			</tbody>
                		</table>
                	</div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Usuarios del Sistema
                </div>
                <div class="panel-body">
	                <%=form_tag :controller => "main", :action => "assign_system_manager" do%>
		                <div class="table-options-wrapper">
		                	<div class="col-lg-8">
		                		<%=select_tag :role, options_for_select(@roles.collect{|r| [r.rolename, r.id]}), :class => "form-control"%>
		                	</div>
		                	<div class="col-lg-4">
		                		<div class="pull-right">
		                			<%=submit_tag "Asignar Usuario", :class => "btn btn-default"%>
		                		</div>
		                	</div>
		                </div>
                		<table class="table table-striped table-bordered table-hover" id="users-table">
                			<thead>
                				<th></th>
                				<th>Nombre</th>
                				<th>Username</th>
                			</thead>
                			<tbody>
                				<%@remaining_users.each do |u|%>
                				<tr>
                					<td><%=check_box_tag "user[]", u.id %></td>
                					<td><%=u.firstname+" "+u.lastname%></td>
                					<td><%=u.username%></td>
                				</tr>
                				<%end%>
                			</tbody>
                		</table>
	                <%end%>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    $('#users-table').dataTable();
});
</script>